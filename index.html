<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
  <meta name="description" content="VOID RIFT - A browser-based twin-stick shooter with intense action and deep customization">
  <meta name="theme-color" content="#4ade80">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>VOID RIFT</title>
  <!-- Link external styles -->
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- START SCREEN -->
  <div id="startScreen">
    <div id="gameTitle">VOID RIFT</div>
    <canvas id="startGraphicCanvas"></canvas>
    <div class="difficultySelector">
      <label for="difficultySelect">Difficulty:</label>
      <select id="difficultySelect" class="difficultyDropdown">
        <option value="easy">Easy - Relaxed Pace</option>
        <option value="normal" selected>Normal - Balanced</option>
        <option value="hard">Hard - Intense Action</option>
      </select>
    </div>
    <div class="menuRow">
      <button id="startButton" class="menuButton">Start Game</button>
      <button id="openShopFromStart" class="menuButton menuSecondary">Upgrades / Shop</button>
      <button id="settingsButton" class="menuButton menuSecondary">Ship Hangar</button>
      <button id="leaderboardButton" class="menuButton menuSecondary">Leaderboard</button>
    </div>
  </div>

  <!-- AUTHENTICATION MODAL -->
  <div id="authModal" class="modal">
    <div class="modal-content auth-modal">
      <div class="modal-header">
        <h2>Player Login</h2>
        <button id="closeAuth" class="closeBtn">‚úï</button>
      </div>
      <div class="auth-content">
        <div class="auth-section">
          <p style="color: #94a3b8; font-size: 14px; margin-bottom: 16px;">
            Sign in to save your scores to the leaderboard
          </p>
          <label>
            <span class="auth-label">Username</span>
            <input type="text" id="authUsername" class="auth-input" placeholder="Enter username" autocomplete="username" />
          </label>
          <label>
            <span class="auth-label">Password</span>
            <input type="password" id="authPassword" class="auth-input" placeholder="Enter password" autocomplete="current-password" />
          </label>
          <div id="authError" class="auth-error"></div>
        </div>
      </div>
      <div class="modal-footer">
        <button id="authRegister" class="secondaryBtn">Register</button>
        <button id="authLogin" class="primaryBtn">Login</button>
      </div>
    </div>
  </div>

  <!-- LEADERBOARD MODAL -->
  <div id="leaderboardModal" class="modal">
    <div class="modal-content leaderboard-modal">
      <div class="modal-header">
        <h2>Leaderboard</h2>
        <button id="closeLeaderboard" class="closeBtn">‚úï</button>
      </div>
      <div class="leaderboard-content">
        <div class="leaderboard-user-info">
          <span id="leaderboardUsername">Not logged in</span>
          <button id="leaderboardLogout" class="secondaryBtn" style="display: none;">Logout</button>
          <button id="leaderboardLogin" class="secondaryBtn">Login</button>
        </div>
        <div class="leaderboard-filter">
          <button class="filter-btn active" data-difficulty="all">All</button>
          <button class="filter-btn" data-difficulty="easy">Easy</button>
          <button class="filter-btn" data-difficulty="normal">Normal</button>
          <button class="filter-btn" data-difficulty="hard">Hard</button>
        </div>
        <div id="leaderboardList" class="leaderboard-list">
          <!-- Leaderboard entries will be populated here -->
        </div>
      </div>
    </div>
  </div>

  <!-- GAME CONTAINER -->
  <div id="gameContainer">
    <canvas id="gameCanvas"></canvas>
    
    <!-- HUD -->
    <div id="uiPanel">
      <div class="ui-stat-row"><span class="ui-text-label">Score:</span><span id="scoreValue" class="ui-text-value">0</span></div>
      <div class="ui-stat-row"><span class="ui-text-label">Level:</span><span id="levelValue" class="ui-text-value">1</span></div>
      <div class="ui-stat-row"><span class="ui-text-label">Pilot Lv:</span><span id="pilotLevelValue" class="ui-text-value">1</span></div>
      <div class="ui-stat-row"><span class="ui-text-label">HP:</span>
        <div class="ui-bar-container"><div id="healthBar" class="ui-bar-fill"></div></div>
      </div>
      <div class="ui-stat-row"><span class="ui-text-label">Ammo:</span>
        <div class="ui-bar-container"><div id="ammoBar" class="ui-bar-fill"></div></div>
      </div>
      <div class="ui-stat-row"><span class="ui-text-label">XP:</span>
        <div class="ui-bar-container xp"><div id="xpBar" class="ui-bar-fill"></div></div>
        <span id="xpText" class="ui-text-value">0%</span>
      </div>
      <div class="ui-stat-row"><span class="ui-text-label">Ult:</span>
        <div class="ui-bar-container ult"><div id="ultBar" class="ui-bar-fill"></div></div>
        <span id="ultText" class="ui-text-value">0%</span>
      </div>
      <div class="ui-stat-row loadoutRow">
        <span class="ui-text-label">Sec:</span><span id="secondaryText" class="ui-text-value">0</span>
        <span class="ui-text-label">Def:</span><span id="defenseText" class="ui-text-value">Ready</span>
      </div>
      <div id="creditsBadge"><span class="creditLabel">CR</span><span id="creditsText">0</span></div>
    </div>
    
    <!-- ACTION LOG -->
    <div id="actionLog"></div>
    
    <!-- EQUIPMENT SLOT INDICATOR -->
    <div id="equipmentIndicator">
      <div class="equip-slot active" data-slot="0">
        <span class="equip-icon">üî´</span>
        <span class="equip-label">Primary</span>
      </div>
      <div class="equip-slot" data-slot="1">
        <span class="equip-icon">üõ°Ô∏è</span>
        <span class="equip-label">Slot 2</span>
      </div>
      <div class="equip-slot" data-slot="2">
        <span class="equip-icon">üí£</span>
        <span class="equip-label">Slot 3</span>
      </div>
      <div class="equip-slot" data-slot="3">
        <span class="equip-icon">üöÄ</span>
        <span class="equip-label">Slot 4</span>
      </div>
    </div>
    
    <!-- MOBILE CONTROLS -->
    <div id="mobileControls">
      <!-- Floating joystick zones -->
      <div id="leftTouchZone" class="touchZone">
        <div id="joystickMoveBase" class="joystickBase"><div id="joystickMoveStick" class="joystickStick"></div></div>
      </div>
      <div id="rightTouchZone" class="touchZone">
        <div id="joystickShootBase" class="joystickBase"><div id="joystickShootStick" class="joystickStick"></div></div>
      </div>
      
      <!-- Removed ability button - now using tap-to-switch -->
      
      <!-- Unified menu button (pause + settings merged) -->
      <button id="unifiedMenuButton" class="settingsButton">‚ò∞</button>
    </div>
    
    <!-- Pause Menu Modal -->
    <div id="pauseMenuModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="pauseMenuTitle">
      <div class="modal-content pause-menu">
        <div class="modal-header">
          <h2 id="pauseMenuTitle">‚è∏ Game Paused</h2>
        </div>
        <div class="pause-menu-content">
          <button id="resumeGameBtn" class="pause-menu-btn primary" aria-label="Resume Game">‚ñ∂ Resume Game</button>
          <button id="restartGameBtn" class="pause-menu-btn" aria-label="Restart Game">üîÑ Restart Game</button>
          <button id="saveGameBtn" class="pause-menu-btn" aria-label="Save Game">üíæ Save Game</button>
          <button id="loadGameBtn" class="pause-menu-btn" aria-label="Load Game">üìÇ Load Game</button>
          <button id="pauseShopBtn" class="pause-menu-btn" aria-label="Upgrades Shop">üõí Upgrades & Shop</button>
          <button id="pauseHangarBtn" class="pause-menu-btn" aria-label="Ship Hangar">üöÄ Ship Hangar</button>
          <button id="pauseLeaderboardBtn" class="pause-menu-btn" aria-label="Leaderboard">üèÜ Leaderboard</button>
          <button id="exitToMenuBtn" class="pause-menu-btn danger" aria-label="Exit to Main Menu">üö™ Exit to Main Menu</button>
          <div id="pauseMenuMessage" class="pause-menu-message"></div>
        </div>
      </div>
    </div>
    
    <!-- Game Over Modal -->
    <div id="gameOverModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="gameOverTitle">
      <div class="modal-content game-over-screen">
        <div class="game-over-header">
          <h1 id="gameOverTitle">üíÄ GAME OVER</h1>
        </div>
        <div class="game-over-stats">
          <div class="stat-item">
            <span class="stat-label">Final Score</span>
            <span id="gameOverScore" class="stat-value">0</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Level Reached</span>
            <span id="gameOverLevel" class="stat-value">1</span>
          </div>
          <div class="stat-item" id="gameOverRankContainer">
            <span class="stat-label">Leaderboard Rank</span>
            <span id="gameOverRank" class="stat-value rank-badge">#1</span>
          </div>
          <div id="gameOverLoginPrompt" class="login-prompt" style="display: none;">
            <p>üîì Login to save your score to the leaderboard!</p>
          </div>
        </div>
        <div class="game-over-actions">
          <button id="gameOverRestartBtn" class="game-over-btn primary">üîÑ Play Again</button>
          <button id="gameOverShopBtn" class="game-over-btn">üõí Upgrades & Shop</button>
          <button id="gameOverHangarBtn" class="game-over-btn">üöÄ Ship Hangar</button>
          <button id="gameOverLeaderboardBtn" class="game-over-btn">üèÜ Leaderboard</button>
          <button id="gameOverLoginBtn" class="game-over-btn" style="display: none;">üîë Login</button>
          <button id="gameOverMenuBtn" class="game-over-btn secondary">üè† Main Menu</button>
        </div>
      </div>
    </div>
    
    <!-- Unified Menu Modal (combines pause, settings, weapons, equipment) -->
    <div id="controlSettingsModal" class="modal">
      <div class="modal-content unified-menu">
        <div class="modal-header">
          <h2>Game Menu</h2>
          <button id="closeControlSettings" class="closeBtn">‚úï</button>
        </div>
        
        <!-- Tab Navigation -->
        <div class="menu-tabs">
          <button class="menu-tab active" data-tab="equipment">Equipment</button>
          <button class="menu-tab" data-tab="upgrades">Upgrades</button>
          <button class="menu-tab" data-tab="weapons">Weapons</button>
          <button class="menu-tab" data-tab="controls">Controls</button>
        </div>
        
        <!-- Equipment Class Tab -->
        <div class="tab-content active" id="equipmentTab">
          <div class="settings-section">
            <h3>Configure Equipment Loadout</h3>
            <p style="color: #94a3b8; font-size: 13px; margin-bottom: 16px;">
              Slot 1 must be a primary weapon. Use 2 taps to switch to slot 2, 3 taps for slot 3, etc.
            </p>
            
            <div class="equipment-slot-config">
              <label>
                <span>Slot 1 (Primary) - Always Active</span>
                <select id="equipSlot1" class="equipment-select">
                  <option value="primary:pulse">Pulse Blaster</option>
                  <option value="primary:scatter">Scatter Coil</option>
                  <option value="primary:rail">Rail Lance</option>
                  <option value="primary:ionburst">Ion Burst</option>
                </select>
              </label>
              
              <label>
                <span>Slot 2 - 2 Taps to Activate</span>
                <select id="equipSlot2" class="equipment-select">
                  <option value="defense:aegis">Aegis Shield</option>
                  <option value="defense:reflector">Reflector Veil</option>
                  <option value="secondary:nova">Nova Bomb</option>
                  <option value="secondary:cluster">Cluster Barrage</option>
                  <option value="boost">Boost</option>
                </select>
              </label>
              
              <label>
                <span>Slot 3 - 3 Taps to Activate</span>
                <select id="equipSlot3" class="equipment-select">
                  <option value="secondary:nova">Nova Bomb</option>
                  <option value="secondary:cluster">Cluster Barrage</option>
                  <option value="defense:aegis">Aegis Shield</option>
                  <option value="defense:reflector">Reflector Veil</option>
                  <option value="boost">Boost</option>
                </select>
              </label>
              
              <label>
                <span>Slot 4 - 4 Taps to Activate</span>
                <select id="equipSlot4" class="equipment-select">
                  <option value="boost">Boost</option>
                  <option value="ultimate:voidstorm">Voidstorm</option>
                  <option value="ultimate:solarbeam">Solar Beam</option>
                  <option value="defense:aegis">Aegis Shield</option>
                  <option value="secondary:nova">Nova Bomb</option>
                </select>
              </label>
            </div>
            
            <p style="color: #60a5fa; font-size: 12px; margin-top: 12px;">
              üí° Tap anywhere on screen (not joysticks) to cycle equipment: 2 taps = slot 2, 3 taps = slot 3, etc.
            </p>
          </div>
        </div>
        
        <!-- Upgrades Tab -->
        <div class="tab-content" id="upgradesTab">
          <div id="upgradesContent"></div>
        </div>
        
        <!-- Weapons Tab -->
        <div class="tab-content" id="weaponsTab">
          <div id="weaponsContent"></div>
        </div>
        
        <!-- Controls Tab -->
        <div class="tab-content" id="controlsTab">
          <div class="settings-section">
            <h3>Layout</h3>
            <label>
              <span>Control Opacity</span>
              <input type="range" id="controlOpacity" min="30" max="100" value="90">
              <span id="opacityValue">90%</span>
            </label>
            <label>
              <span>Joystick Size</span>
              <input type="range" id="joystickSize" min="80" max="140" value="100">
              <span id="joystickSizeValue">100%</span>
            </label>
          </div>
          <div class="settings-section">
            <h3>Sensitivity</h3>
            <label>
              <span>Movement Sensitivity</span>
              <input type="range" id="moveSensitivity" min="50" max="150" value="100">
              <span id="moveSensValue">100%</span>
            </label>
            <label>
              <span>Aim Sensitivity</span>
              <input type="range" id="aimSensitivity" min="50" max="150" value="100">
              <span id="aimSensValue">100%</span>
            </label>
            <label>
              <span>Deadzone</span>
              <input type="range" id="deadzone" min="5" max="25" value="12">
              <span id="deadzoneValue">12%</span>
            </label>
          </div>
          <div class="settings-section">
            <h3>Advanced</h3>
            <label class="checkbox-label">
              <input type="checkbox" id="floatingJoysticks" checked>
              <span>Floating Joysticks (appear where you touch)</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="hapticFeedback" checked>
              <span>Haptic Feedback</span>
            </label>
          </div>
          <div class="settings-section">
            <h3>Display Options</h3>
            <label class="checkbox-label">
              <input type="checkbox" id="showFPSToggle">
              <span>Show FPS Counter (or press G)</span>
            </label>
            <button id="fullscreenToggle" class="fullscreenBtn">Toggle Fullscreen (F key)</button>
          </div>
        </div>
        
        <div class="modal-footer">
          <button id="resetControls" class="secondaryBtn">Reset to Default</button>
          <button id="saveControls" class="primaryBtn">Save & Close</button>
        </div>
      </div>
    </div>
    
    <!-- MESSAGE BOX FOR LEVELS/GAME OVER -->
    <div id="messageBox">
      <div id="messageTitle">LEVEL 1</div>
      <div id="messageText">Kill 10 enemies to advance!</div>
      <button id="messageButton">Start</button>
    </div>
  </div>

  <!-- SHOP MODAL -->
  <div id="shopModal">
    <div id="shopCard">
      <div id="shopHeader">
        <div id="shopTitle">Upgrades &amp; Mods</div>
        <div class="shopHeaderActions">
          <span class="shopCredits">CR <span id="shopCredits">0</span></span>
          <button id="openHangarFromShop" class="secondaryBtn">Hangar</button>
          <button id="closeShop">Close</button>
        </div>
      </div>
      <div class="shopGrid" id="shopGrid"></div>
    </div>
  </div>

  <!-- HANGAR MODAL -->
  <div id="hangarModal">
    <div id="hangarCard">
      <div id="hangarHeader">
        <div id="hangarTitle">Ship Hangar</div>
        <button id="closeHangar">Close</button>
      </div>
      <div id="hangarGrid"></div>
    </div>
  </div>

  <!-- Include external scripts -->
  <script src="backend-api.js"></script>
  <script src="script.js"></script>
</body>
</html>
